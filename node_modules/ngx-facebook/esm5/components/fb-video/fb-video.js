import { __decorate, __extends } from "tslib";
import { Component, Input, Output, ElementRef, Renderer2, OnInit, OnDestroy, EventEmitter } from '@angular/core';
import { FBMLAttribute, FBMLComponent, FBMLInstanceMethod } from '../fbml-component';
/**
 * @name Embedded Video
 * @shortdesc Component to embed Facebook videos
 * @fbdoc https://developers.facebook.com/docs/plugins/embedded-video-player
 * @description Component to embed Facebook videos and control them.
 * @usage
 * ```html
 * <!-- basic usage -->
 * <fb-video href="https://www.facebook.com/facebook/videos/10153231379946729/"></fb-video>
 *
 * <!-- event emitters -->
 * <fb-video href="https://www.facebook.com/facebook/videos/10153231379946729/" (paused)="onVideoPaused($event)"></fb-video>
 * ```
 *
 * To manually interact with the video player, fetch it using `ViewChild`.
 *
 * ```ts
 * import { Component, ViewChild } from '@angular/core';
 * import { FBVideoComponent } from 'ngx-facebook-sdk';
 *
 * @Component(...)
 * export class MyComponent {
 *
 *   @ViewChild(FBVideoComponent) video: FBVideoComponent;
 *
 *   ngAfterViewInit() {
 *     this.video.play();
 *     this.video.pause();
 *     this.video.getVolume();
 *   }
 *
 * }
 *
 * ```
 */
var FBVideoComponent = /** @class */ (function (_super) {
    __extends(FBVideoComponent, _super);
    function FBVideoComponent(el, rnd) {
        var _this = _super.call(this, el, rnd, 'fb-video') || this;
        /**
         * Fired when video starts to play.
         */
        _this.startedPlaying = new EventEmitter();
        /**
         * Fired when video pauses.
         */
        _this.paused = new EventEmitter();
        /**
         *
         Fired when video finishes playing.
         */
        _this.finishedPlaying = new EventEmitter();
        /**
         * Fired when video starts to buffer.
         */
        _this.startedBuffering = new EventEmitter();
        /**
         * Fired when video recovers from buffering.
         */
        _this.finishedBuffering = new EventEmitter();
        /**
         * Fired when an error occurs on the video.
         */
        _this.error = new EventEmitter();
        _this._listeners = [];
        _this.nativeElement.id = _this._id = 'video-' + String(Math.floor((Math.random() * 10000) + 1));
        return _this;
    }
    /**
     * @hidden
     */
    FBVideoComponent.prototype.ngOnInit = function () {
        var _this = this;
        FB.Event.subscribe('xfbml.ready', function (msg) {
            if (msg.type === 'video' && msg.id === _this._id) {
                _this._instance = msg.instance;
                _this._listeners.push(_this._instance.subscribe('startedPlaying', function (e) { return _this.startedPlaying.emit(e); }), _this._instance.subscribe('paused', function (e) { return _this.paused.emit(e); }), _this._instance.subscribe('finishedPlaying', function (e) { return _this.finishedPlaying.emit(e); }), _this._instance.subscribe('startedBuffering', function (e) { return _this.startedBuffering.emit(e); }), _this._instance.subscribe('finishedBuffering', function (e) { return _this.finishedBuffering.emit(e); }), _this._instance.subscribe('error', function (e) { return _this.error.emit(e); }));
            }
        });
    };
    /**
     * @hidden
     */
    FBVideoComponent.prototype.ngOnDestroy = function () {
        this._listeners.forEach(function (l) {
            if (typeof l.release === 'function') {
                l.release();
            }
        });
    };
    /**
     * Plays the video.
     */
    FBVideoComponent.prototype.play = function () { };
    /**
     * Pauses the video.
     */
    FBVideoComponent.prototype.pause = function () { };
    /**
     * Seeks to specified position.
     * @param seconds {number}
     */
    FBVideoComponent.prototype.seek = function (seconds) { };
    /**
     * Mute the video.
     */
    FBVideoComponent.prototype.mute = function () { };
    /**
     * Unmute the video.
     */
    FBVideoComponent.prototype.unmute = function () { };
    /**
     * Returns true if video is muted, false if not.
     */
    FBVideoComponent.prototype.isMuted = function () { return; };
    /**
     * Set the volume
     * @param volume
     */
    FBVideoComponent.prototype.setVolume = function (volume) { };
    /**
     * Get the volume
     */
    FBVideoComponent.prototype.getVolume = function () { return; };
    /**
     * Returns the current video time position in seconds
     */
    FBVideoComponent.prototype.getCurrentPosition = function () { };
    /**
     * Returns the video duration in seconds
     */
    FBVideoComponent.prototype.getDuration = function () { };
    FBVideoComponent.ctorParameters = function () { return [
        { type: ElementRef },
        { type: Renderer2 }
    ]; };
    __decorate([
        Input(),
        FBMLAttribute
    ], FBVideoComponent.prototype, "href", void 0);
    __decorate([
        Input(),
        FBMLAttribute
    ], FBVideoComponent.prototype, "allowfullscreen", void 0);
    __decorate([
        Input(),
        FBMLAttribute
    ], FBVideoComponent.prototype, "autoplay", void 0);
    __decorate([
        Input(),
        FBMLAttribute
    ], FBVideoComponent.prototype, "width", void 0);
    __decorate([
        Input(),
        FBMLAttribute
    ], FBVideoComponent.prototype, "showText", void 0);
    __decorate([
        Input(),
        FBMLAttribute
    ], FBVideoComponent.prototype, "showCaptions", void 0);
    __decorate([
        Output()
    ], FBVideoComponent.prototype, "startedPlaying", void 0);
    __decorate([
        Output()
    ], FBVideoComponent.prototype, "paused", void 0);
    __decorate([
        Output()
    ], FBVideoComponent.prototype, "finishedPlaying", void 0);
    __decorate([
        Output()
    ], FBVideoComponent.prototype, "startedBuffering", void 0);
    __decorate([
        Output()
    ], FBVideoComponent.prototype, "finishedBuffering", void 0);
    __decorate([
        Output()
    ], FBVideoComponent.prototype, "error", void 0);
    __decorate([
        FBMLInstanceMethod
    ], FBVideoComponent.prototype, "play", null);
    __decorate([
        FBMLInstanceMethod
    ], FBVideoComponent.prototype, "pause", null);
    __decorate([
        FBMLInstanceMethod
    ], FBVideoComponent.prototype, "seek", null);
    __decorate([
        FBMLInstanceMethod
    ], FBVideoComponent.prototype, "mute", null);
    __decorate([
        FBMLInstanceMethod
    ], FBVideoComponent.prototype, "unmute", null);
    __decorate([
        FBMLInstanceMethod
    ], FBVideoComponent.prototype, "isMuted", null);
    __decorate([
        FBMLInstanceMethod
    ], FBVideoComponent.prototype, "setVolume", null);
    __decorate([
        FBMLInstanceMethod
    ], FBVideoComponent.prototype, "getVolume", null);
    __decorate([
        FBMLInstanceMethod
    ], FBVideoComponent.prototype, "getCurrentPosition", null);
    __decorate([
        FBMLInstanceMethod
    ], FBVideoComponent.prototype, "getDuration", null);
    FBVideoComponent = __decorate([
        Component({
            selector: 'fb-video',
            template: ''
        })
    ], FBVideoComponent);
    return FBVideoComponent;
}(FBMLComponent));
export { FBVideoComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmItdmlkZW8uanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZ3gtZmFjZWJvb2svIiwic291cmNlcyI6WyJjb21wb25lbnRzL2ZiLXZpZGVvL2ZiLXZpZGVvLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNqSCxPQUFPLEVBQUUsYUFBYSxFQUFFLGFBQWEsRUFBRSxrQkFBa0IsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBR3JGOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBa0NHO0FBS0g7SUFBc0Msb0NBQWE7SUF1RmpELDBCQUNFLEVBQWMsRUFDZCxHQUFjO1FBRmhCLFlBSUUsa0JBQU0sRUFBRSxFQUFFLEdBQUcsRUFBRSxVQUFVLENBQUMsU0FFM0I7UUEvQ0Q7O1dBRUc7UUFFSCxvQkFBYyxHQUFzQixJQUFJLFlBQVksRUFBTyxDQUFDO1FBRTVEOztXQUVHO1FBRUgsWUFBTSxHQUFzQixJQUFJLFlBQVksRUFBTyxDQUFDO1FBRXBEOzs7V0FHRztRQUVILHFCQUFlLEdBQXNCLElBQUksWUFBWSxFQUFPLENBQUM7UUFFN0Q7O1dBRUc7UUFFSCxzQkFBZ0IsR0FBc0IsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUU5RDs7V0FFRztRQUVILHVCQUFpQixHQUFzQixJQUFJLFlBQVksRUFBTyxDQUFDO1FBRS9EOztXQUVHO1FBRUgsV0FBSyxHQUFzQixJQUFJLFlBQVksRUFBTyxDQUFDO1FBSTNDLGdCQUFVLEdBQVUsRUFBRSxDQUFDO1FBTzdCLEtBQUksQ0FBQyxhQUFhLENBQUMsRUFBRSxHQUFHLEtBQUksQ0FBQyxHQUFHLEdBQUcsUUFBUSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxH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NkRBQ1c7SUFPekI7UUFGQyxLQUFLLEVBQUU7UUFDUCxhQUFhO3NEQUNJO0lBT2xCO1FBRkMsS0FBSyxFQUFFO1FBQ1AsYUFBYTttREFDQTtJQU9kO1FBRkMsS0FBSyxFQUFFO1FBQ1AsYUFBYTtzREFDSTtJQU9sQjtRQUZDLEtBQUssRUFBRTtRQUNQLGFBQWE7MERBQ1E7SUFNdEI7UUFEQyxNQUFNLEVBQUU7NERBQ21EO0lBTTVEO1FBREMsTUFBTSxFQUFFO29EQUMyQztJQU9wRDtRQURDLE1BQU0sRUFBRTs2REFDb0Q7SUFNN0Q7UUFEQyxNQUFNLEVBQUU7OERBQ3FEO0lBTTlEO1FBREMsTUFBTSxFQUFFOytEQUNzRDtJQU0vRDtRQURDLE1BQU0sRUFBRTttREFDMEM7SUFnRG5EO1FBREMsa0JBQWtCO2dEQUNWO0lBTVQ7UUFEQyxrQkFBa0I7aURBQ1Q7SUFPVjtRQURDLGtCQUFrQjtnREFDSztJQU14QjtRQURDLGtCQUFrQjtnREFDVjtJQU1UO1FBREMsa0JBQWtCO2tEQUNSO0lBTVg7UUFEQyxrQkFBa0I7bURBQ1c7SUFPOUI7UUFEQyxrQkFBa0I7cURBQ1M7SUFNNUI7UUFEQyxrQkFBa0I7cURBQ1k7SUFNL0I7UUFEQyxrQkFBa0I7OERBQ0k7SUFNdkI7UUFEQyxrQkFBa0I7dURBQ0g7SUF6TEwsZ0JBQWdCO1FBSjVCLFNBQVMsQ0FBQztZQUNULFFBQVEsRUFBRSxVQUFVO1lBQ3BCLFFBQVEsRUFBRSxFQUFFO1NBQ2IsQ0FBQztPQUNXLGdCQUFnQixDQTJMNUI7SUFBRCx1QkFBQztDQUFBLEFBM0xELENBQXNDLGFBQWEsR0EyTGxEO1NBM0xZLGdCQUFnQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE91dHB1dCwgRWxlbWVudFJlZiwgUmVuZGVyZXIyLCBPbkluaXQsIE9uRGVzdHJveSwgRXZlbnRFbWl0dGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBGQk1MQXR0cmlidXRlLCBGQk1MQ29tcG9uZW50LCBGQk1MSW5zdGFuY2VNZXRob2QgfSBmcm9tICcuLi9mYm1sLWNvbXBvbmVudCc7XG5kZWNsYXJlIHZhciBGQjogYW55O1xuXG4vKipcbiAqIEBuYW1lIEVtYmVkZGVkIFZpZGVvXG4gKiBAc2hvcnRkZXNjIENvbXBvbmVudCB0byBlbWJlZCBGYWNlYm9vayB2aWRlb3NcbiAqIEBmYmRvYyBodHRwczovL2RldmVsb3BlcnMuZmFjZWJvb2suY29tL2RvY3MvcGx1Z2lucy9lbWJlZGRlZC12aWRlby1wbGF5ZXJcbiAqIEBkZXNjcmlwdGlvbiBDb21wb25lbnQgdG8gZW1iZWQgRmFjZWJvb2sgdmlkZW9zIGFuZCBjb250cm9sIHRoZW0uXG4gKiBAdXNhZ2VcbiAqIGBgYGh0bWxcbiAqIDwhLS0gYmFzaWMgdXNhZ2UgLS0+XG4gKiA8ZmItdmlkZW8gaHJlZj1cImh0dHBzOi8vd3d3LmZhY2Vib29rLmNvbS9mYWNlYm9vay92aWRlb3MvMTAxNTMyMzEzNzk5NDY3MjkvXCI+PC9mYi12aWRlbz5cbiAqXG4gKiA8IS0tIGV2ZW50IGVtaXR0ZXJzIC0tPlxuICogPGZiLXZpZGVvIGhyZWY9XCJodHRwczovL3d3dy5mYWNlYm9vay5jb20vZmFjZWJvb2svdmlkZW9zLzEwMTUzMjMxMzc5OTQ2NzI5L1wiIChwYXVzZWQpPVwib25WaWRlb1BhdXNlZCgkZXZlbnQpXCI+PC9mYi12aWRlbz5cbiAqIGBgYFxuICpcbiAqIFRvIG1hbnVhbGx5IGludGVyYWN0IHdpdGggdGhlIHZpZGVvIHBsYXllciwgZmV0Y2ggaXQgdXNpbmcgYFZpZXdDaGlsZGAuXG4gKlxuICogYGBgdHNcbiAqIGltcG9ydCB7IENvbXBvbmVudCwgVmlld0NoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG4gKiBpbXBvcnQgeyBGQlZpZGVvQ29tcG9uZW50IH0gZnJvbSAnbmd4LWZhY2Vib29rLXNkayc7XG4gKlxuICogQENvbXBvbmVudCguLi4pXG4gKiBleHBvcnQgY2xhc3MgTXlDb21wb25lbnQge1xuICpcbiAqICAgQFZpZXdDaGlsZChGQlZpZGVvQ29tcG9uZW50KSB2aWRlbzogRkJWaWRlb0NvbXBvbmVudDtcbiAqXG4gKiAgIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAqICAgICB0aGlzLnZpZGVvLnBsYXkoKTtcbiAqICAgICB0aGlzLnZpZGVvLnBhdXNlKCk7XG4gKiAgICAgdGhpcy52aWRlby5nZXRWb2x1bWUoKTtcbiAqICAgfVxuICpcbiAqIH1cbiAqXG4gKiBgYGBcbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnZmItdmlkZW8nLFxuICB0ZW1wbGF0ZTogJydcbn0pXG5leHBvcnQgY2xhc3MgRkJWaWRlb0NvbXBvbmVudCBleHRlbmRzIEZCTUxDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XG5cbiAgcHJpdmF0ZSBfaW5zdGFuY2U6IGFueTtcblxuICAvKipcbiAgICogVGhlIGFic29sdXRlIFVSTCBvZiB0aGUgdmlkZW8uXG4gICAqL1xuICBASW5wdXQoKVxuICBARkJNTEF0dHJpYnV0ZVxuICBocmVmOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEFsbG93IHRoZSB2aWRlbyB0byBiZSBwbGF5ZWQgaW4gZnVsbHNjcmVlbiBtb2RlLiBDYW4gYmUgZmFsc2Ugb3IgdHJ1ZS4gRGVmYXVsdHMgdG8gZmFsc2U7XG4gICAqL1xuICBASW5wdXQoKVxuICBARkJNTEF0dHJpYnV0ZVxuICBhbGxvd2Z1bGxzY3JlZW46IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIEF1dG9tYXRpY2FsbHkgc3RhcnQgcGxheWluZyB0aGUgdmlkZW8gd2hlbiB0aGUgcGFnZSBsb2Fkcy4gVGhlIHZpZGVvIHdpbGwgYmUgcGxheWVkIHdpdGhvdXQgc291bmQgKG11dGVkKS4gUGVvcGxlIGNhbiB0dXJuIG9uIHNvdW5kIHZpYSB0aGUgdmlkZW8gcGxheWVyIGNvbnRyb2xzLiBUaGlzIHNldHRpbmcgZG9lcyBub3QgYXBwbHkgdG8gbW9iaWxlIGRldmljZXMuIENhbiBiZSBmYWxzZSBvciB0cnVlLiBEZWZhdWx0cyB0byBmYWxzZS5cbiAgICovXG4gIEBJbnB1dCgpXG4gIEBGQk1MQXR0cmlidXRlXG4gIGF1dG9wbGF5OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGUgd2lkdGggb2YgdGhlIHZpZGVvIGNvbnRhaW5lci4gTWluLiAyMjBweC5cbiAgICovXG4gIEBJbnB1dCgpXG4gIEBGQk1MQXR0cmlidXRlXG4gIHdpZHRoOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFNldCB0byB0cnVlIHRvIGluY2x1ZGUgdGhlIHRleHQgZnJvbSB0aGUgRmFjZWJvb2sgcG9zdCBhc3NvY2lhdGVkIHdpdGggdGhlIHZpZGVvLCBpZiBhbnkuXG4gICAqL1xuICBASW5wdXQoKVxuICBARkJNTEF0dHJpYnV0ZVxuICBzaG93VGV4dDogYm9vbGVhbjtcblxuICAvKipcbiAgICogU2V0IHRvIHRydWUgdG8gc2hvdyBjYXB0aW9ucyAoaWYgYXZhaWxhYmxlKSBieSBkZWZhdWx0LiBDYXB0aW9ucyBhcmUgb25seSBhdmFpbGFibGUgb24gZGVza3RvcC5cbiAgICovXG4gIEBJbnB1dCgpXG4gIEBGQk1MQXR0cmlidXRlXG4gIHNob3dDYXB0aW9uczogYm9vbGVhbjtcblxuICAvKipcbiAgICogRmlyZWQgd2hlbiB2aWRlbyBzdGFydHMgdG8gcGxheS5cbiAgICovXG4gIEBPdXRwdXQoKVxuICBzdGFydGVkUGxheWluZzogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAvKipcbiAgICogRmlyZWQgd2hlbiB2aWRlbyBwYXVzZXMuXG4gICAqL1xuICBAT3V0cHV0KClcbiAgcGF1c2VkOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gIC8qKlxuICAgKlxuICAgRmlyZWQgd2hlbiB2aWRlbyBmaW5pc2hlcyBwbGF5aW5nLlxuICAgKi9cbiAgQE91dHB1dCgpXG4gIGZpbmlzaGVkUGxheWluZzogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAvKipcbiAgICogRmlyZWQgd2hlbiB2aWRlbyBzdGFydHMgdG8gYnVmZmVyLlxuICAgKi9cbiAgQE91dHB1dCgpXG4gIHN0YXJ0ZWRCdWZmZXJpbmc6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgLyoqXG4gICAqIEZpcmVkIHdoZW4gdmlkZW8gcmVjb3ZlcnMgZnJvbSBidWZmZXJpbmcuXG4gICAqL1xuICBAT3V0cHV0KClcbiAgZmluaXNoZWRCdWZmZXJpbmc6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgLyoqXG4gICAqIEZpcmVkIHdoZW4gYW4gZXJyb3Igb2NjdXJzIG9uIHRoZSB2aWRlby5cbiAgICovXG4gIEBPdXRwdXQoKVxuICBlcnJvcjogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICBwcml2YXRlIF9pZDogc3RyaW5nO1xuXG4gIHByaXZhdGUgX2xpc3RlbmVyczogYW55W10gPSBbXTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBlbDogRWxlbWVudFJlZixcbiAgICBybmQ6IFJlbmRlcmVyMlxuICApIHtcbiAgICBzdXBlcihlbCwgcm5kLCAnZmItdmlkZW8nKTtcbiAgICB0aGlzLm5hdGl2ZUVsZW1lbnQuaWQgPSB0aGlzLl9pZCA9ICd2aWRlby0nICsgU3RyaW5nKE1hdGguZmxvb3IoKE1hdGgucmFuZG9tKCkgKiAxMDAwMCkgKyAxKSk7XG4gIH1cblxuICAvKipcbiAgICogQGhpZGRlblxuICAgKi9cbiAgbmdPbkluaXQoKSB7XG4gICAgRkIuRXZlbnQuc3Vic2NyaWJlKCd4ZmJtbC5yZWFkeScsIChtc2c6IGFueSkgPT4ge1xuICAgICAgaWYgKG1zZy50eXBlID09PSAndmlkZW8nICYmIG1zZy5pZCA9PT0gdGhpcy5faWQpIHtcbiAgICAgICAgdGhpcy5faW5zdGFuY2UgPSBtc2cuaW5zdGFuY2U7XG4gICAgICAgIHRoaXMuX2xpc3RlbmVycy5wdXNoKFxuICAgICAgICAgIHRoaXMuX2luc3RhbmNlLnN1YnNjcmliZSgnc3RhcnRlZFBsYXlpbmcnLCAoZTogYW55KSA9PiB0aGlzLnN0YXJ0ZWRQbGF5aW5nLmVtaXQoZSkpLFxuICAgICAgICAgIHRoaXMuX2luc3RhbmNlLnN1YnNjcmliZSgncGF1c2VkJywgKGU6IGFueSkgPT4gdGhpcy5wYXVzZWQuZW1pdChlKSksXG4gICAgICAgICAgdGhpcy5faW5zdGFuY2Uuc3Vic2NyaWJlKCdmaW5pc2hlZFBsYXlpbmcnLCAoZTogYW55KSA9PiB0aGlzLmZpbmlzaGVkUGxheWluZy5lbWl0KGUpKSxcbiAgICAgICAgICB0aGlzLl9pbnN0YW5jZS5zdWJzY3JpYmUoJ3N0YXJ0ZWRCdWZmZXJpbmcnLCAoZTogYW55KSA9PiB0aGlzLnN0YXJ0ZWRCdWZmZXJpbmcuZW1pdChlKSksXG4gICAgICAgICAgdGhpcy5faW5zdGFuY2Uuc3Vic2NyaWJlKCdmaW5pc2hlZEJ1ZmZlcmluZycsIChlOiBhbnkpID0+IHRoaXMuZmluaXNoZWRCdWZmZXJpbmcuZW1pdChlKSksXG4gICAgICAgICAgdGhpcy5faW5zdGFuY2Uuc3Vic2NyaWJlKCdlcnJvcicsIChlOiBhbnkpID0+IHRoaXMuZXJyb3IuZW1pdChlKSlcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAaGlkZGVuXG4gICAqL1xuICBuZ09uRGVzdHJveSgpIHtcbiAgICB0aGlzLl9saXN0ZW5lcnMuZm9yRWFjaChsID0+IHtcbiAgICAgIGlmICh0eXBlb2YgbC5yZWxlYXNlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGwucmVsZWFzZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBsYXlzIHRoZSB2aWRlby5cbiAgICovXG4gIEBGQk1MSW5zdGFuY2VNZXRob2RcbiAgcGxheSgpIHt9XG5cbiAgLyoqXG4gICAqIFBhdXNlcyB0aGUgdmlkZW8uXG4gICAqL1xuICBARkJNTEluc3RhbmNlTWV0aG9kXG4gIHBhdXNlKCkge31cblxuICAvKipcbiAgICogU2Vla3MgdG8gc3BlY2lmaWVkIHBvc2l0aW9uLlxuICAgKiBAcGFyYW0gc2Vjb25kcyB7bnVtYmVyfVxuICAgKi9cbiAgQEZCTUxJbnN0YW5jZU1ldGhvZFxuICBzZWVrKHNlY29uZHM6IG51bWJlcikge31cblxuICAvKipcbiAgICogTXV0ZSB0aGUgdmlkZW8uXG4gICAqL1xuICBARkJNTEluc3RhbmNlTWV0aG9kXG4gIG11dGUoKSB7fVxuXG4gIC8qKlxuICAgKiBVbm11dGUgdGhlIHZpZGVvLlxuICAgKi9cbiAgQEZCTUxJbnN0YW5jZU1ldGhvZFxuICB1bm11dGUoKSB7fVxuXG4gIC8qKlxuICAgKiBSZXR1cm5zIHRydWUgaWYgdmlkZW8gaXMgbXV0ZWQsIGZhbHNlIGlmIG5vdC5cbiAgICovXG4gIEBGQk1MSW5zdGFuY2VNZXRob2RcbiAgaXNNdXRlZCgpOiBib29sZWFuIHsgcmV0dXJuOyB9XG5cbiAgLyoqXG4gICAqIFNldCB0aGUgdm9sdW1lXG4gICAqIEBwYXJhbSB2b2x1bWVcbiAgICovXG4gIEBGQk1MSW5zdGFuY2VNZXRob2RcbiAgc2V0Vm9sdW1lKHZvbHVtZTogbnVtYmVyKSB7fVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIHZvbHVtZVxuICAgKi9cbiAgQEZCTUxJbnN0YW5jZU1ldGhvZFxuICBnZXRWb2x1bWUoKTogbnVtYmVyIHsgcmV0dXJuOyB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGN1cnJlbnQgdmlkZW8gdGltZSBwb3NpdGlvbiBpbiBzZWNvbmRzXG4gICAqL1xuICBARkJNTEluc3RhbmNlTWV0aG9kXG4gIGdldEN1cnJlbnRQb3NpdGlvbigpIHt9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIHZpZGVvIGR1cmF0aW9uIGluIHNlY29uZHNcbiAgICovXG4gIEBGQk1MSW5zdGFuY2VNZXRob2RcbiAgZ2V0RHVyYXRpb24oKSB7fVxuXG59XG4iXX0=